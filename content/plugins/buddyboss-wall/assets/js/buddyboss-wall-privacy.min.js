function buddyboss_wall_initiate_privacy_form(e){return $link=$(e),$form=$("#form_buddyboss-wall-privacy"),$form_wrapper=$form.parent(),$link.closest(".activity").find("form.ac-form").slideUp(),$form_wrapper.is(":visible")?(buddyboss_wall_privacy_close(),!1):($link.closest(".activity-content").after($form_wrapper),$selected_visibilty=$link.data("visibility"),$selected_visibilty_group=$link.hasClass("buddyboss-group-privacy-filter"),(!$selected_visibilty_group&&"grouponly"===$selected_visibilty||!$selected_visibilty)&&($selected_visibilty="onlyme"),$form.find("#bbwall-privacy-selectbox").val($selected_visibilty),$form_wrapper.slideDown(200),bbmedia_move_media_opened=!0,$form.find('input[name="activity_id"]').val($link.data("activity_id")),!1)}function buddyboss_wall_privacy_close(){return $form=$("#form_buddyboss-wall-privacy"),$form_wrapper=$form.parent(),$form_wrapper.slideUp(200),bbmedia_move_media_opened=!1,!1}function buddyboss_wall_submit_privacy(){if($form=$("#form_buddyboss-wall-privacy"),$form_wrapper=$form.parent(),$submit_button=$form.find('input[type="submit"]'),$animated_loader=$form.find(".privacy-filter-ajax-loader"),$submit_button.hasClass("loading"))return!1;$animated_loader.css("display","inline-block");var e={action:"buddyboss_wall_update_activity_privacy",bboss_wall_privacy_nonce:$form.find('input[name="bboss_wall_privacy_nonce"]').val(),activity_id:$form.find('input[name="activity_id"]').val(),buddyboss_activity_visibility:$form.find('select[name="bbwall-privacy-selectbox"]').val()};return $submit_button.addClass("loading"),$form.find("#message").removeAttr("class").html(""),$.ajax({type:"POST",url:ajaxurl,data:e,success:function(e){$curr_visibility=$form.find("#bbwall-privacy-selectbox").val(),$form_wrapper.closest(".activity").find(".buddyboss_privacy_filter").data("visibility",$curr_visibility),$animated_loader.hide(),e=$.parseJSON(e),e.status?($form.find("#message").addClass("updated").html("<p>"+e.message+"</p>"),setTimeout(function(){buddyboss_wall_privacy_cleanup($form,!1)},2e3)):$form.find("#message").addClass("error").html("<p>"+e.message+"</p>"),$submit_button.removeClass("loading")}}),!1}function buddyboss_wall_privacy_cleanup(e,i){e.find("#message").removeAttr("class").html(""),$form_wrapper=e.parent(),buddyboss_wall_privacy_close(),i&&($activity=e.closest(".activity"),$("body").append($form_wrapper),$form_wrapper.hide(),$activity.slideUp(200,function(){$activity.remove()}))}if("undefined"==typeof jq)var jq=jQuery;jq(document).ready(function(){jq("span#activity-visibility").prependTo("div#whats-new-submit"),jq("input#aw-whats-new-submit").off("click");var e=jq("select#whats-new-post-in").val();jq("select#whats-new-post-in").data("selected",e),void 0!=e&&0!=e&&jq("select#bbwall-activity-privacy").replaceWith(visibility_levels.groups),jq("select#whats-new-post-in").on("change",function(){var e=jq(this).data("selected"),i=jq("#whats-new-post-in").val();0==i&&i!=e?jq("select#bbwall-activity-privacy").replaceWith(visibility_levels.profil):0!=i&&0==e&&jq("select#bbwall-activity-privacy").replaceWith(visibility_levels.groups),jq("select#bbwall-activity-privacy").next().remove(),jq(this).data("selected",i)}),jq("input#aw-whats-new-submit").on("click",function(){var e=jq(this),i=e.parent().parent().parent().parent();i.children().each(function(){(jq.nodeName(this,"textarea")||jq.nodeName(this,"input"))&&jq(this).prop("disabled",!0)}),jq("div.error").remove(),e.addClass("loading"),e.prop("disabled",!0);var t="",a=jq("#whats-new-post-in").val(),s=jq("textarea#whats-new").val(),l=jq("select#bbwall-activity-privacy").val();if(a>0&&(t=jq("#whats-new-post-object").val()),"function"==typeof bp_get_cookies)var r=bp_get_cookies();else var r=encodeURIComponent(document.cookie);return jq.post(ajaxurl,{action:"post_update",cookie:r,_wpnonce_post_update:jq("input#_wpnonce_post_update").val(),content:s,visibility:l,object:t,item_id:a,_bp_as_nonce:jq("#_bp_as_nonce").val()||""},function(e){i.children().each(function(){(jq.nodeName(this,"textarea")||jq.nodeName(this,"input"))&&jq(this).prop("disabled",!1)}),e[0]+e[1]=="-1"?(i.prepend(e.substr(2,e.length)),jq("form#"+i.attr("id")+" div.error").hide().fadeIn(200)):(0==jq("ul.activity-list").length&&(jq("div.error").slideUp(100).remove(),jq("div#message").slideUp(100).remove(),jq("div.activity").append('<ul id="activity-stream" class="activity-list item-list">')),jq("ul#activity-stream").prepend(e),jq("ul#activity-stream li:first").addClass("new-update"),jq("li.new-update").hide().slideDown(300),jq("li.new-update").removeClass("new-update"),jq("textarea#whats-new").val("")),jq("#whats-new-options").animate({height:"0px"}),jq("form#whats-new-form textarea").animate({height:"20px"}),jq("#aw-whats-new-submit").prop("disabled",!0).removeClass("loading"),jq("select#bbwall-activity-privacy option[selected]").prop("selected",!0).trigger("change")}),!1})});